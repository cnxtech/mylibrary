<nav role="navigation" aria-label="Main navigation" id="mainnav" class="pt-3 pb-3">
  <ul class="nav nav-pills nav-justified container">
    <li class="nav-item">
      <%= link_to root_path, class: "nav-link #{active_page_class('summaries')}" do %>
        <%= sul_icon :'sharp-person-24px', classes: 'lg' %>
        <span class="label">Summary</span>
        <span class="info"><%= patron.status %></span>
      <% end %>
    </li>
    <li class="nav-item">
      <%= link_to checkouts_path, class: "nav-link #{active_page_class('checkouts')}" do %>
        <%= sul_icon :'sharp-playlist_add_check-24px', classes: 'lg' %>
        <span class="label">Checkouts</span>
        <% recalled_count = patron.checkouts.select(&:recalled?).length %>
        <% overdue_count = patron.checkouts.select(&:overdue?).length %>
        <% if recalled_count.positive? %>
          <span class="info text-recalled"><%= sul_icon :'sharp-error-24px' %> <%= pluralize(recalled_count, 'recall') %></span>
        <% elsif overdue_count.positive? %>
          <span class="info text-overdue"><%= sul_icon :'sharp-warning-24px' %> <%= overdue_count %> overdue</span>
        <% else %>
          <span class="info"><%= patron.checkouts.length %></span>
        <% end %>
      <% end %>
    </li>
    <li class="nav-item">
      <%= link_to requests_path, class: "nav-link #{active_page_class('requests')}" do %>
        <%= sul_icon :'sharp-access_time-24px', classes: 'lg' %>
        <span class="label">Requests</span>
        <% pickup_count = patron.requests.select(&:ready_for_pickup?).length %>
        <% if pickup_count.positive? %>
          <span class="info text-ready"><%= sul_icon :'sharp-check_circle-24px' %> <%= pickup_count %> ready</span>
        <% else %>
          <span class="info"><%= patron.requests.length %></span>
        <% end %>
      <% end %>
    </li>
    <li class="nav-item">
      <%= link_to fines_path, class: "nav-link #{active_page_class('fines')}" do %>
        <%= sul_icon :'sharp-attach_money-24px', classes: 'lg' %>
        <span class="label">Fines</span>
        <% owed = patron.fines.sum(&:owed) %>
        <% accruing = patron.checkouts.sum(&:accrued) %>
        <% if owed.positive? %>
          <span class="info text-recalled"><%= sul_icon :'sharp-error-24px' %> <%= number_to_currency(owed) %></span>
        <% elsif accruing.positive? %>
          <span class="info text-overdue"><%= sul_icon :'sharp-warning-24px' %> <%= number_to_currency(accruing) %></span>
        <% else %>
          <span class="info"><%= number_to_currency(0) %></span>
        <% end %>
      <% end %>
    </li>
  </ul>
</nav>
