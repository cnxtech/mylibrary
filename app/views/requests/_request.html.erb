<li class="row d-flex flex-wrap list-group-item">
  <div class="d-flex flex-row flex-grow-1 justify-content-between w-100 row col-md-4">
    <div class="w-50 col-md-6 library">
      <% if request.ready_for_pickup? %>
        <span class="text-ready">
          <%= sul_icon 'sharp-check_circle-24px' %>
          <span class="d-md-none">Pick up at </span><%= library_name request.pickup_library %>
        </span>
      <% else %>
        <span class="d-md-none">Deliver to </span><%= library_name request.pickup_library %>
      <% end %>

    </div>
    <% if request.expiration_date %>
      <div class="w-50 col-md-6 text-right text-md-left date" data-date="<%= request.expiration_date.strftime('%FT%T') %>">
        <%= l(request.expiration_date, format: :short) %>
      </div>
    <% elsif request.fill_by_date %>
      <div class="w-50 col-md-6 text-right text-md-left date" data-date="<%= request.fill_by_date.strftime('%FT%T') %>">
        <%= l(request.fill_by_date, format: :short) %>
      </div>
    <% end %>
  </div>
  <div class="d-flex flex-grow-1 flex-column flex-md-row w-75 row col-md-8">
    <h3 class="col-md-7 clamp-2 record-title title text-reset"><%= request.title %></h3>
    <div class="d-flex flex-row row col-md-5">
      <div class="w-50 col-md-6 clamp-1 author"><%= request.author %></div>
      <div class="w-50 col-md-6 call_number" data-shelfkey="<%= request.shelf_key %>"><%= request.call_number %></div>
    </div>
  </div>
  <div>
    <button class="btn collapsed" type="button" data-toggle="collapse" data-target="#collapseDetails-<%= request.key.parameterize %>" aria-expanded="false" aria-controls="collapseDetails-<%= request.key.parameterize %>">
      <span class="expand-icon"><%= sul_icon :'sharp-add-24px' %><span class="sr-only">Expand</span></span>
      <span class="collapse-icon"><%= sul_icon :'sharp-remove-24px' %><span class="sr-only">Collapse</span></span>
    </button>
  </div>
  <div class="collapse w-100" id="collapseDetails-<%= request.key.parameterize %>">
    <div class="row mb-0">
      <div class="col-11 offset-1 col-md-10 offset-md-2">
        <% if request.ready_for_pickup? %>
          <%= form_tag request_path(request.key), method: :delete do %>
            <%= hidden_field_tag :resource, request.resource %>
            <%= hidden_field_tag :title, request.title %>
            <%= button_tag class: 'btn btn-link btn-request-cancel btn-icon-prefix', type: 'submit' do %>
              <%= sul_icon 'outline-cancel-24px' %> Cancel this request
            <% end %>
          <% end %>
        <% else %>
          <%= link_to edit_request_path(request.key), data: { 'mylibrary-modal' => 'trigger' } do %>
            <%= sul_icon 'outline-cancel-24px' %> Cancel or change this request
          <% end %>
        <% end %>
      </div>
    </div>
    <dl class="row mb-0">
      <% if params[:group] %>
        <dt class="col-3 offset-1 col-md-2 offset-md-2">Borrower:</dt>
        <dd class="col-8"><%= patron.group.member_name(request.patron_key) %></dd>
      <% end %>
      <% if request.placed_date %>
        <dt class="col-3 offset-1 col-md-2 offset-md-2">Requested:</dt>
        <dd class="col-8"><%= l(request.placed_date, format: :short) %></dd>
      <% end %>
      <dt class="col-3 offset-1 col-md-2 offset-md-2">Waitlist position:</dt>
      <dd class="col-8"><%= request.waitlist_position %></dd>
      <dt class="col-3 offset-1 col-md-2 offset-md-2">Source:</dt>
      <dd class="col-8"><%= library_name request.placed_library %></dd>
    </dl>

    <%= detail_link_to_searchworks(request.catkey) %>
  </div>
</li>
