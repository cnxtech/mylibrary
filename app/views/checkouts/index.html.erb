<h1 class="sr-only">Checkouts</h1>

<% content_for(:navigation) do %>
  <%= render 'shared/navigation' %>
  <%= render partial: 'shared/group_tabs', locals: { self_value: patron.checkouts.length, group_value: patron.group.checkouts.length } if patron_or_group.group? %>
<% end %>
<% if @checkouts.any? %>
  <% recalled, other_checkouts = @checkouts.partition(&:recalled?) %>
  <div class="page-section">
    <h2>Recalled: <%= recalled.length %></h2>
      <% if recalled.any? %>
        <div class="d-none d-md-flex row font-weight-bold list-header">
          <div class="row col-md-4">
            <div class="col-md-6">Status</div>
            <div class="col-md-6">Due date</div>
          </div>
          <div class="row col-md-8">
            <div class="col-md-7">Title</div>
            <div class="row col-md-5">
              <div class="col-md-6">Author</div>
              <div class="col-md-6 call_number">Call number</div>
            </div>
          </div>
        </div>
        <ul class="recalled-checkouts list-group">
          <%= render recalled %>
        </ul>
      <% end %>
  </div>

  <div id="checkouts" class="page-section">
    <div class="d-flex justify-content-between">
      <h2>Checked out: <%= other_checkouts.length %><%= " (#{patron_or_group.remaining_checkouts} remaining)" if patron_or_group.remaining_checkouts %></h2>
      <div class="dropdown">
        <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Sort (<span data-sort-label>Due date</span>)
        </a>

        <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
          <li class="dropdown-item" data-sort="status">Status</li>
          <li class="dropdown-item active" data-sort="due_date">Due date</li>
          <li class="dropdown-item" data-sort="title">Title</li>
          <li class="dropdown-item" data-sort="author">Author name</li>
          <li class="dropdown-item" data-sort="call_number">Call number</li>
        </ul>
      </div>
    </div>

    <% if other_checkouts.any?(&:renewable?) %>
      <%= link_to all_eligible_renewals_path(group: params[:group]), class: 'btn btn-info mb-3', method: :post do %>
        <%= sul_icon :'renew' %> Renew <%= pluralize(other_checkouts.count(&:renewable?), 'eligible item') %>
      <% end %>
    <% end %>

    <div class="d-none d-md-flex row font-weight-bold list-header">
      <div class="row col-md-4">
        <div class="col-md-6" data-sort="status">Status</div>
        <div class="col-md-6 active" data-sort="due_date">Due date</div>
      </div>
      <div class="row col-md-8">
        <div class="col-md-7" data-sort="title">Title</div>
        <div class="row col-md-5">
          <div class="col-md-6" data-sort="author">Author</div>
          <div class="col-md-6 call_number" data-sort="call_number">Call number</div>
        </div>
      </div>
    </div>
    <ul class="list checkouts list-group">
      <%= render other_checkouts %>
    </ul>
  </div>
<% else %>
  <h2>Checked out: <%= @checkouts.length %><%= " (#{patron_or_group.remaining_checkouts} remaining)" if patron_or_group.remaining_checkouts %></h2>
<% end %>
<div class="page-section">
  <h2>Policies &amp; information</h2>
  <ul class="list-unstyled">
    <li>
      <%= link_to 'https://library.stanford.edu/using/borrow-renew-return/renew', target: '_blank' do %>
        <%= sul_icon :'sharp-open_in_new-24px' %> Renewal policies
      <% end %>
    </li>
    <li>
      <%= link_to 'https://library.stanford.edu/using/borrow-renew-return/did-you-lose-item', target: '_blank' do %>
        <%= sul_icon :'sharp-open_in_new-24px' %> Did you lose an item?
      <% end %>
    </li>
    <li>
      <%= link_to 'https://library.stanford.edu/using/borrow-renew-return/return', target: '_blank' do %>
        <%= sul_icon :'sharp-open_in_new-24px' %> Returning items by mail
      <% end %>
    </li>
  </ul>
</div>
